<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FantaTennis</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#1a472a,#0f2818);
  min-height:100vh;
  padding:20px;
}
.container{max-width:1400px;margin:auto}
.title{
  text-align:center;
  font-size:2.5em;
  font-weight:900;
  color:#FFD700;
  margin-bottom:25px;
}

/* GENERALI */
table{width:100%;border-collapse:collapse}
th,td{text-align:center;padding:6px}
th{
  background:#1a472a;
  color:white;
  font-size:0.85em;
}
input{
  width:100%;
  padding:6px;
  text-align:center;
  font-weight:bold;
}

/* TORNEI */
.table-wrapper{
  background:white;
  padding:15px;
  border-radius:15px;
  margin-bottom:20px;
}
.total-row{
  background:#1a472a;
  color:white;
  font-weight:bold;
}

/* AVATAR */
.player-avatar{
  width:45px;height:45px;
  border-radius:50%;
  overflow:hidden;
  margin:auto;
}
.player-avatar img{width:100%;height:100%;object-fit:cover}
.player-name{font-size:0.75em;color:white}

/* STATISTICHE */
.stats-wrapper{
  background:#1a472a;
  border-radius:15px;
  padding:10px;
  margin-bottom:20px;
}
.stats-wrapper th,
.stats-wrapper td{
  color:white;
  font-size:0.8em;
  font-weight:bold;
  padding:4px;
  border-bottom:1px solid rgba(255,255,255,0.3);
}
.stats-player{
  cursor:pointer;
  text-decoration:underline;
}
.stats-player:hover{color:#FFD700}

/* BOTTONI */
.controls{text-align:center;margin-top:20px}
button{
  padding:10px 18px;
  border:none;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
  margin:5px;
}
.primary{background:#FFD700}
.success{background:#27ae60;color:white}
.danger{background:#e74c3c;color:white}

/* MODAL */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
}
.modal-content{
  background:white;
  width:90%;
  max-width:400px;
  margin:15% auto;
  padding:20px;
  border-radius:12px;
}
.modal-header{
  font-size:1.3em;
  font-weight:bold;
  margin-bottom:15px;
}
</style>
</head>

<body>
<div class="container">
  <div class="title">âš¡ FantaTennis 2026</div>

  <!-- TORNEI -->
  <div class="table-wrapper">
    <table>
      <thead id="tablehead"></thead>
      <tbody id="tablebody"></tbody>
    </table>
  </div>

  <!-- STATISTICHE -->
  <div class="stats-wrapper">
    <table>
      <thead>
        <tr>
          <th>Giocatore</th>
          <th>ðŸ¥‡</th>
          <th>ðŸ¥ˆ</th>
          <th>ðŸ¥‰</th>
        </tr>
      </thead>
      <tbody id="statsbody"></tbody>
    </table>
  </div>

  <!-- CONTROLLI -->
  <div class="controls">
    <button class="primary" onclick="openModal()">+ Torneo</button>
    <button class="success" onclick="saveData()">ðŸ’¾ Salva</button>
    <button class="danger" onclick="resetData()">ðŸ”„ Reset</button>
  </div>
</div>

<!-- MODAL TORNEO -->
<div id="modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">Nuovo torneo</div>
    <input id="tournamentname" placeholder="Nome torneo" style="width:100%;padding:8px">
    <br><br>
    <button class="primary" onclick="addTournament()">Aggiungi</button>
    <button onclick="closeModal()">Annulla</button>
  </div>
</div>

<!-- MODAL PALMARES -->
<div id="palmaresModal" class="modal">
  <div class="modal-content">
    <div class="modal-header" id="palmaresTitle"></div>
    <div id="palmaresBody"></div>
    <br>
    <button onclick="closePalmares()">Chiudi</button>
  </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/12.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyBqkJaCnZ6Hzm7ytyoj3_dKeZ0kuNbJXbI",
  authDomain: "fantatennis-ecd35.firebaseapp.com",
  projectId: "fantatennis-ecd35"
});
const db=firebase.firestore();
</script>

<script>
const players=[
  {name:'Gennaro',photo:'Gennaro.jpg'},
  {name:'Mirko',photo:'Mirko.jpg'},
  {name:'Federico',photo:'Federico.jpg'},
  {name:'Ciro',photo:'Ciro.jpg'},
  {name:'Damiano',photo:'Damiano.jpg'},
  {name:'Carlo',photo:'Carlo.jpg'},
  {name:'Francesco',photo:'Francesco.jpg'},
  {name:'Friarello',photo:'Friarello.jpg'},
  {name:'Giuseppe',photo:'Giuseppe.jpg'},
  {name:'Donatello',photo:'Donatello.jpg'}
];

let tournaments=[];

/* RENDER */
function render(){
  renderHead();
  renderBody();
  renderStats();
}

function renderHead(){
  tablehead.innerHTML='<tr><th>TORNEO</th>'+
  players.map(p=>`
    <th>
      <div class="player-avatar"><img src="${p.photo}"></div>
      <div class="player-name">${p.name}</div>
    </th>`).join('')+'</tr>';
}

function renderBody(){
  tablebody.innerHTML='';
  tournaments.forEach((t,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${t.name}</td>`+
    players.map((p,j)=>`
      <td>
        <input type="number" value="${t.scores[j]||''}"
        onchange="updateScore(${i},${j},this.value)">
      </td>`).join('');
    tablebody.appendChild(tr);
  });

  const total=document.createElement('tr');
  total.className='total-row';
  total.innerHTML='<td>TOTALE</td>'+
  players.map((p,j)=>`<td>${getTotal(j)}</td>`).join('');
  tablebody.appendChild(total);
}

function renderStats(){
  statsbody.innerHTML='';
  players.forEach((p,i)=>{
    let w=0,s=0,t=0;
    tournaments.forEach(tr=>{
      const scores=players.map((_,j)=>+tr.scores[j]||0);
      const ord=[...scores].sort((a,b)=>b-a);
      if(scores[i]===ord[0]&&ord[0])w++;
      else if(scores[i]===ord[1]&&ord[1])s++;
      else if(scores[i]===ord[2]&&ord[2])t++;
    });
    statsbody.innerHTML+=`
      <tr>
        <td class="stats-player" onclick="openPalmares(${i})">${p.name}</td>
        <td>${w}</td><td>${s}</td><td>${t}</td>
      </tr>`;
  });
}

/* PALMARES */
function openPalmares(i){
  const p=players[i];
  let w=[],s=[],t=[];
  tournaments.forEach(tr=>{
    const scores=players.map((_,j)=>+tr.scores[j]||0);
    const ord=[...scores].sort((a,b)=>b-a);
    if(scores[i]===ord[0]&&ord[0])w.push(tr.name);
    else if(scores[i]===ord[1]&&ord[1])s.push(tr.name);
    else if(scores[i]I will 
